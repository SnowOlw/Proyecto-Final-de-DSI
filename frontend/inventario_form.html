<!-- ...existing code... -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    
    <title>Formulario de Producto</title>
</head>

<body >
<div class="sidebar">
        <h2>ğŸ‘• Inventario</h2>
        <a class="menu-btn btn-inventario" href="inventario_list.html">ğŸ“‹ Ver Inventario</a>
        <a class="menu-btn btn-nuevo" href="inventario_form.html">ğŸ›ï¸ Nuevo Producto</a>
        <a class="menu-btn btn-proveedores" href="proveedores_list.html">ğŸ‘¥ Proveedores</a>
        <a class="menu-btn btn-reportes" href="reportes.html">ğŸ“‘ Reportes</a>
    </div>
<header>ğŸ“ Registrar / Editar Producto</header>

<div class="container">

    <a href="inventario_list.html" class="btn">â¬… Volver</a>

      <h2>Formulario de Producto</h2>

    <!-- agregado id y campos con ids para que el script los encuentre -->
    <form id="productoForm" style="margin-top: 25px; display: flex; flex-direction: column; gap: 20px;">

        <!-- hidden para ediciÃ³n -->
        <input type="hidden" id="productoId" value="">

        <div>
            <label>Nombre del Producto</label>
            <input id="nombre" name="nombre" type="text" placeholder="Ej: Zolo Jeans" required
                style="width: 100%; padding: 12px; border-radius: 8px; background: #2a2a2a; color: #fff; border: 1px solid #444;">
        </div>

        <div>
            <label>CategorÃ­a</label>
            <input id="categoria" name="categoria" type="text" placeholder="Ej: AlmacÃ©n / bodega /vuelo " required
                style="width: 100%; padding: 12px; border-radius: 8px; background: #2a2a2a; color: #fff; border: 1px solid #444;">
        </div>

        <div>
            <label>Cantidad</label>
            <!-- id cambiado a 'cantidad' para que coincida con el script y con la DB -->
            <input id="cantidad" name="cantidad" type="number" min="0" placeholder="Ej: 34" required
                style="width: 100%; padding: 12px; border-radius: 8px; background: #2a2a2a; color: #fff; border: 1px solid #444;">
        </div>

        <div>
            <label>Precio (C$)</label>
            <input id="precio" name="precio" type="number" min="0" step="0.01" placeholder="Ej: 150" required
                style="width: 100%; padding: 12px; border-radius: 8px; background: #2a2a2a; color: #fff; border: 1px solid #444;">
        </div>

        <div>
            <label>DescripciÃ³n</label>
            <textarea id="descripcion" name="descripcion" placeholder="Detalles opcionales del productoâ€¦" rows="4"
                style="width: 100%; padding: 12px; border-radius: 8px; background: #2a2a2a; color: #fff; border: 1px solid #444;"></textarea>
        </div>

        <button class="btn btn-success" type="submit">ğŸ’¾ Guardar</button>

    </form>

</div>

<!-- script colocado despuÃ©s del formulario para asegurar que los elementos existen -->
<script>
  const API_URL = "http://localhost:1337/api/productos";

  const form = document.getElementById("productoForm");
  const idInput = document.getElementById("productoId");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    // obtener elementos guardando referencias y comprobando existencia
    const nombreEl = document.getElementById("nombre");
    const categoriaEl = document.getElementById("categoria");
    const cantidadEl = document.getElementById("cantidad");
    const precioEl = document.getElementById("precio");
    const descripcionEl = document.getElementById("descripcion");

    if (!nombreEl || !categoriaEl || !cantidadEl || !precioEl || !descripcionEl) {
      console.error("Faltan campos en el formulario. Revisa los ids.");
      alert("Error: faltan campos en el formulario. Revisa la consola.");
      return;
    }

    const nombre = nombreEl.value.trim();
    const categoria = categoriaEl.value.trim();
    const cantidad = Number(cantidadEl.value);
    const precio = Number(precioEl.value);
    const descripcion = descripcionEl.value.trim();

    if (!nombre || !categoria || Number.isNaN(cantidad) || Number.isNaN(precio)) {
      alert("Completa los campos obligatorios y asegÃºrate de valores numÃ©ricos vÃ¡lidos.");
      return;
    }

    // Payload usando 'cantidad' (nombre del atributo en tu DB)
    const payload = {
      data: {
        nombre,
        categoria,
        cantidad,
        precio,
        descripcion
      }
    };

    try {
      const headers = { "Content-Type": "application/json", "Accept": "application/json" };
      // si usas token, aÃ±Ã¡delo aquÃ­: headers["Authorization"] = `Bearer ${token}`;

      let res;
      if (idInput.value) {
        res = await fetch(`${API_URL}/${idInput.value}`, {
          method: "PUT",
          headers,
          body: JSON.stringify(payload)
        });
      } else {
        res = await fetch(API_URL, {
          method: "POST",
          headers,
          body: JSON.stringify(payload)
        });
      }

      const result = await res.json().catch(() => null);
      console.log("Strapi response:", res.status, result);

      if (!res.ok) {
        const msg = result?.error?.message || result?.message || JSON.stringify(result) || `HTTP ${res.status}`;
        throw new Error(msg);
      }

      alert(idInput.value ? "Producto actualizado correctamente." : "Producto registrado correctamente.");
      window.location.href = "inventario_list.html";
    } catch (err) {
      console.error("Error al guardar producto:", err);
      alert("Error al guardar el producto: " + (err.message || err));
    }
  });
</script>


</body>
</html>
<!-- ...existing code... -->