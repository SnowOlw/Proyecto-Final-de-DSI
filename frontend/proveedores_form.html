<!-- ...existing code... -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Proveedores - Nuevo / Editar</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="sidebar">
    <h2>ğŸ‘• Inventario</h2>
    <a class="menu-btn btn-inventario" href="inventario_list.html">ğŸ“‹ Ver Inventario</a>
    <a class="menu-btn btn-nuevo" href="inventario_form.html">ğŸ›ï¸ Nuevo Producto</a>
    <a class="menu-btn btn-proveedores" href="proveedores_list.html">ğŸ‘¥ Proveedores</a>
    <a class="menu-btn btn-reportes" href="reportes.html">ğŸ“‘ Reportes</a>
  </div>

  <div class="main-content">
    <header><h2 id="pageTitle">Nuevo Proveedor</h2></header>

    <div class="container">
      <form id="proveedorForm" class="p-4 rounded" style="background: var(--card); max-width: 720px;">
        <input type="hidden" id="proveedorId" value="">

        <div class="mb-3">
          <label class="form-label">Nombre del Proveedor</label>
          <input id="nombre" type="text" class="form-control" placeholder="Ej. Distribuidora Fashion" required>
        </div>

        <div class="mb-3">
          <label class="form-label">UbicaciÃ³n</label>
          <input id="ubicacion" type="text" class="form-control" placeholder="Ej. Managua">
        </div>

        <div class="mb-3">
          <label class="form-label">MercaderÃ­a</label>
          <input id="mercaderia" type="text" class="form-control" placeholder="Ropa, zapatos, etc.">
        </div>

        <div class="mb-3">
          <label class="form-label">TelÃ©fono</label>
          <input id="telefono" type="text" class="form-control" placeholder="8888-2222">
        </div>

        <div style="display:flex; gap:10px; margin-top:20px;">
          <button type="submit" class="btn btn-success">Guardar</button>
          <a href="proveedores_list.html" class="btn btn-light">Cancelar</a>
        </div>
      </form>

      <a href="index.html" class="btn d-inline-block btn-secondary mt-3">â¬… Volver al inicio</a>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

  <script>
    // Ajusta si tu collection type tiene otro nombre
    const API_URL = "http://localhost:1337/api/proveedors";
    const TOKEN = localStorage.getItem('strapiToken') || null;

    const form = document.getElementById('proveedorForm');
    const idInput = document.getElementById('proveedorId');
    const pageTitle = document.getElementById('pageTitle');

    const nombreEl = document.getElementById('nombre');
    const ubicacionEl = document.getElementById('ubicacion');
    const mercaderiaEl = document.getElementById('mercaderia');
    const telefonoEl = document.getElementById('telefono');

    // Leer query param ?id=
    function getQueryId() {
      const params = new URLSearchParams(window.location.search);
      return params.get('id');
    }

    async function loadProveedor(id) {
      try {
        const headers = { 'Accept': 'application/json' };
        if (TOKEN) headers['Authorization'] = `Bearer ${TOKEN}`;
        const res = await fetch(`${API_URL}/${id}`, { headers });
        if (!res.ok) {
          const body = await res.json().catch(() => null);
          throw new Error(body?.error?.message || body?.message || `HTTP ${res.status}`);
        }
        const json = await res.json();
        const data = json?.data;
        const attrs = data?.attributes || {};
        idInput.value = data?.id || id;
        pageTitle.textContent = 'Editar Proveedor';

        // Ajusta segÃºn nombres reales en Strapi
        nombreEl.value = attrs.nombre ?? attrs.name ?? '';
        ubicacionEl.value = attrs.ubicacion ?? attrs.ubicaciÃ³n ?? attrs.location ?? '';
        mercaderiaEl.value = attrs.mercaderia ?? attrs.productos ?? '';
        telefonoEl.value = attrs.telefono ?? attrs.tel ?? attrs.phone ?? '';
      } catch (err) {
        console.error('Error cargando proveedor:', err);
        alert('No se pudo cargar el proveedor. Revisa la consola.');
      }
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const nombre = nombreEl.value.trim();
      const ubicacion = ubicacionEl.value.trim();
      const mercaderia = mercaderiaEl.value.trim();
      const telefono = telefonoEl.value.trim();

      if (!nombre) { alert('El nombre es obligatorio.'); return; }

      const payload = {
        data: {
          nombre,
          ubicacion,
          mercaderia,
          telefono
        }
      };

      try {
        const headers = { 'Content-Type': 'application/json', 'Accept': 'application/json' };
        if (TOKEN) headers['Authorization'] = `Bearer ${TOKEN}`;

        let res;
        if (idInput.value) {
          res = await fetch(`${API_URL}/${idInput.value}`, {
            method: 'PUT',
            headers,
            body: JSON.stringify(payload)
          });
        } else {
          res = await fetch(API_URL, {
            method: 'POST',
            headers,
            body: JSON.stringify(payload)
          });
        }

        const result = await res.json().catch(() => null);
        console.log('Strapi response:', res.status, result);

        if (!res.ok) {
          const msg = result?.error?.message || result?.message || JSON.stringify(result) || `HTTP ${res.status}`;
          throw new Error(msg);
        }

        alert(idInput.value ? 'Proveedor actualizado.' : 'Proveedor creado.');
        window.location.href = 'proveedores_list.html';
      } catch (err) {
        console.error('Error guardando proveedor:', err);
        alert('Error al guardar: ' + (err.message || err));
      }
    });

    // Si viene ?id= precargar para editar
    const qid = getQueryId();
    if (qid) loadProveedor(qid);
  </script>
</body>
</html>
<!-- ...existing code... -->